#!/usr/bin/env zsh
# 
# You need to have JENKINS_USERNAME and JENKINS_TOKEN defined in your environment or pasted here.
# You can find them in your Jenkins profile.
#
# You also need jq, which can be installed from homebrew.
# 
# JENKINS_HOST=
# JENKINS_USERNAME=
# JENKINS_TOKEN=
JENKINS_URI=https://${JENKINS_USERNAME}:${JENKINS_TOKEN}@${JENKINS_HOST}
JENKINS_ICON="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"
API_RESPONSE=$(curl -s ${JENKINS_URI}/queue/api/json)
QUEUE_SIZE=$(jq '.items | length' <<< ${API_RESPONSE})
echo "$QUEUE_SIZE | image=$JENKINS_ICON"
echo "---"
echo "Check build queue in Jenkins | href=$JENKINS_URI"
